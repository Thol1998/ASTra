<?xml version="1.0" encoding="ascii"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>src.vehicle</title>
  <link rel="stylesheet" href="epydoc.css" type="text/css" />
  <script type="text/javascript" src="epydoc.js"></script>
</head>

<body bgcolor="white" text="black" link="blue" vlink="#204080"
      alink="#204080">
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="src-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table width="100%" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%">
      <span class="breadcrumbs">
        <a href="src-module.html">Package&nbsp;src</a> ::
        Module&nbsp;vehicle
      </span>
    </td>
    <td>
      <table cellpadding="0" cellspacing="0">
        <!-- hide/show private -->
        <tr><td align="right"><span class="options">[<a href="javascript:void(0);" class="privatelink"
    onclick="toggle_private();">hide&nbsp;private</a>]</span></td></tr>
        <tr><td align="right"><span class="options"
            >[<a href="frames.html" target="_top">frames</a
            >]&nbsp;|&nbsp;<a href="src.vehicle-module.html"
            target="_top">no&nbsp;frames</a>]</span></td></tr>
      </table>
    </td>
  </tr>
</table>
<!-- ==================== MODULE DESCRIPTION ==================== -->
<h1 class="epydoc">Module vehicle</h1><p class="nomargin-top"><span class="codelink"><a href="src.vehicle-pysrc.html">source&nbsp;code</a></span></p>
<pre class="literalblock">

@file   vehicle.py
@author  Remi Domingues
@date   07/06/2013

This script reads an input socket connected to the remote client and process an request when received.
Requests must be sent on the port 180005, responses are sent on the port 18006.
                
(1) Add request: ADD vehicleId priority lat1 lon1 lat2 lon2 ... latN lonN
                priority = 0 (no priority) or 1 (priority vehicle)
        Followed by (2) Acknowledge response: ACK vehicleId ackCode (See constants for the detailed acknowledge codes)

(3) Delete request: DEL vehicleId1 vehicleId2 ... vehicleId3
                If NO VEHICLE is specified, every vehicle will be deleted
                Followed by (12)

(4) Stress test request: MOC prefixId vehiclesNumber routeLength
        Followed by (12)

(5) Get vehicles speed request: SPE vehicleId1 vehicleId2 ... vehicleIdN
                If NO VEHICLE is specified, the response will contain every vehicle speed
                Followed by (6): SPE vehicleId1 speed1 vehicleId2 speed2 ... vehicleIdN speedN 

(7) Get vehicles geographic coordinates request: COO vehicleId1 vehicleId2 ... vehicleId3
                If NO VEHICLE is specified, the response will contain every vehicle geographic coordinates
                Followed by (8): COO vehicleId1 lon1 lat1 vehicleId2 lon2 lat2 ... vehicleIdN lonN latN

(9) Get arrived vehicles ID: ARR
                Followed by (10): ARR vehicleId1 ... vehicleIdN
        
(11) ERROR response when an invalid request is received : ERR 40

(12) Acknowledge response (14) : ACK returnCode

</pre>

<!-- ==================== FUNCTIONS ==================== -->
<a name="section-Functions"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Functions</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Functions"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="getRouteIdFromVehicleId"></a><span class="summary-sig-name">getRouteIdFromVehicleId</span>(<span class="summary-sig-arg">vehicleId</span>,
        <span class="summary-sig-arg">cRouteId</span>)</span><br />
      Returns a route ID from a user vehicle ID</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#getRouteIdFromVehicleId">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="appendEdge"></a><span class="summary-sig-name">appendEdge</span>(<span class="summary-sig-arg">route</span>,
        <span class="summary-sig-arg">edgesNumber</span>,
        <span class="summary-sig-arg">mtraci</span>)</span><br />
      Appends edgesNumber random following edges to the route given in 
      parameter</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#appendEdge">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="sendIdentifiedAck"></a><span class="summary-sig-name">sendIdentifiedAck</span>(<span class="summary-sig-arg">vehicleId</span>,
        <span class="summary-sig-arg">errorCode</span>,
        <span class="summary-sig-arg">outputSocket</span>)</span><br />
      Sends an acknowledge(2) message to the remote client using an output 
      socket</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#sendIdentifiedAck">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="isRouteValidForTraCI"></a><span class="summary-sig-name">isRouteValidForTraCI</span>(<span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">route</span>)</span><br />
      Returns true if the given route is linked by SUMO lanes, false else</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#isRouteValidForTraCI">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="isRouteValid"></a><span class="summary-sig-name">isRouteValid</span>(<span class="summary-sig-arg">route</span>,
        <span class="summary-sig-arg">junctionsDict</span>,
        <span class="summary-sig-arg">edgesDict</span>)</span><br />
      Return true if each edge contained by the route given is linked with 
      the previous and next edge of the route</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#isRouteValid">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a href="src.vehicle-module.html#addRouteToSumo" class="summary-sig-name">addRouteToSumo</a>(<span class="summary-sig-arg">vehicleId</span>,
        <span class="summary-sig-arg">routeId</span>,
        <span class="summary-sig-arg">route</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">outputSocket</span>)</span><br />
      Adds a vehicle and its route to the SUMO simulation.</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#addRouteToSumo">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="savePriorityVehicles"></a><span class="summary-sig-name">savePriorityVehicles</span>(<span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">vehicleId</span>,
        <span class="summary-sig-arg">priority</span>,
        <span class="summary-sig-arg">priorityVehicles</span>,
        <span class="summary-sig-arg">mPriorityVehicles</span>)</span><br />
      If the vehicle received is priority, this one is append in the 
      priority vehicles shared list protected by a mutex</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#savePriorityVehicles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addVehicle"></a><span class="summary-sig-name">addVehicle</span>(<span class="summary-sig-arg">vehicleId</span>,
        <span class="summary-sig-arg">priority</span>,
        <span class="summary-sig-arg">route</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">cRouteId</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">priorityVehicles</span>,
        <span class="summary-sig-arg">mPriorityVehicles</span>,
        <span class="summary-sig-arg">vehicles</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      Transforms the coordinates to SUMO edges ID</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#addVehicle">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="removeVehicles"></a><span class="summary-sig-name">removeVehicles</span>(<span class="summary-sig-arg">vehiclesToDel</span>,
        <span class="summary-sig-arg">priorityVehicles</span>,
        <span class="summary-sig-arg">mPriorityVehicles</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">vehicles</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      Removes the specified vehicles from the simulation</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#removeVehicles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="addRandomVehicles"></a><span class="summary-sig-name">addRandomVehicles</span>(<span class="summary-sig-arg">vehicleIdPrefix</span>,
        <span class="summary-sig-arg">vehiclesNumber</span>,
        <span class="summary-sig-arg">routeSize</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">vehicles</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      Adds vehiclesNumber vehicles to SUMO, linking each of these to a 
      random route of routeSize edges</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#addRandomVehicles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="sendVehiclesSpeed"></a><span class="summary-sig-name">sendVehiclesSpeed</span>(<span class="summary-sig-arg">vehiclesId</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      Sends the speed of the given vehicles to the distant client</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#sendVehiclesSpeed">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="getRegularVehicles"></a><span class="summary-sig-name">getRegularVehicles</span>(<span class="summary-sig-arg">vehicles</span>)</span><br />
      Returns a vehicle list without the ignored vehicles (See constants)</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#getRegularVehicles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="sendVehiclesCoordinates"></a><span class="summary-sig-name">sendVehiclesCoordinates</span>(<span class="summary-sig-arg">vehiclesId</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      Gets every vehicles position from SUMO and send then these ones to 
      the remote client by an output socket</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#sendVehiclesCoordinates">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="sendArrivedVehicles"></a><span class="summary-sig-name">sendArrivedVehicles</span>(<span class="summary-sig-arg">arrivedVehicles</span>,
        <span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">outputSocket</span>)</span><br />
      Gets all arrived vehicles ID from SUMO and send them to the remote 
      client by output socket</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#sendArrivedVehicles">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
      <table width="100%" cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td><span class="summary-sig"><a name="run"></a><span class="summary-sig-name">run</span>(<span class="summary-sig-arg">mtraci</span>,
        <span class="summary-sig-arg">inputSocket</span>,
        <span class="summary-sig-arg">outputSocket</span>,
        <span class="summary-sig-arg">eShutdown</span>,
        <span class="summary-sig-arg">priorityVehicles</span>,
        <span class="summary-sig-arg">mPriorityVehicles</span>,
        <span class="summary-sig-arg">eVehicleReady</span>,
        <span class="summary-sig-arg">eManagerReady</span>,
        <span class="summary-sig-arg">vehicles</span>,
        <span class="summary-sig-arg">mVehicles</span>)</span><br />
      See file description</td>
          <td align="right" valign="top">
            <span class="codelink"><a href="src.vehicle-pysrc.html#run">source&nbsp;code</a></span>
            
          </td>
        </tr>
      </table>
      
    </td>
  </tr>
</table>
<!-- ==================== VARIABLES ==================== -->
<a name="section-Variables"></a>
<table class="summary" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Variables</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-Variables"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
<tr>
    <td width="15%" align="right" valign="top" class="summary">
      <span class="summary-type">&nbsp;</span>
    </td><td class="summary">
        <a name="__package__"></a><span class="summary-name">__package__</span> = <code title="'src'"><code class="variable-quote">'</code><code class="variable-string">src</code><code class="variable-quote">'</code></code>
    </td>
  </tr>
</table>
<!-- ==================== FUNCTION DETAILS ==================== -->
<a name="section-FunctionDetails"></a>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr bgcolor="#70b0f0" class="table-header">
  <td colspan="2" class="table-header">
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr valign="top">
        <td align="left"><span class="table-header">Function Details</span></td>
        <td align="right" valign="top"
         ><span class="options">[<a href="#section-FunctionDetails"
         class="privatelink" onclick="toggle_private();"
         >hide private</a>]</span></td>
      </tr>
    </table>
  </td>
</tr>
</table>
<a name="addRouteToSumo"></a>
<div>
<table class="details" border="1" cellpadding="3"
       cellspacing="0" width="100%" bgcolor="white">
<tr><td>
  <table width="100%" cellpadding="0" cellspacing="0" border="0">
  <tr valign="top"><td>
  <h3 class="epydoc"><span class="sig"><span class="sig-name">addRouteToSumo</span>(<span class="sig-arg">vehicleId</span>,
        <span class="sig-arg">routeId</span>,
        <span class="sig-arg">route</span>,
        <span class="sig-arg">mtraci</span>,
        <span class="sig-arg">outputSocket</span>)</span>
  </h3>
  </td><td align="right" valign="top"
    ><span class="codelink"><a href="src.vehicle-pysrc.html#addRouteToSumo">source&nbsp;code</a></span>&nbsp;
    </td>
  </tr></table>
  
  <p>Adds a vehicle and its route to the SUMO simulation. An error may be 
  sent to the remote client</p>
  <dl class="fields">
  </dl>
</td></tr></table>
</div>
<br />
<!-- ==================== NAVIGATION BAR ==================== -->
<table class="navbar" border="0" width="100%" cellpadding="0"
       bgcolor="#a0c0ff" cellspacing="0">
  <tr valign="middle">
  <!-- Home link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="src-module.html">Home</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Tree link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="module-tree.html">Trees</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Index link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="identifier-index.html">Indices</a>&nbsp;&nbsp;&nbsp;</th>

  <!-- Help link -->
      <th>&nbsp;&nbsp;&nbsp;<a
        href="help.html">Help</a>&nbsp;&nbsp;&nbsp;</th>

      <th class="navbar" width="100%"></th>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" width="100%%">
  <tr>
    <td align="left" class="footer">
    Generated by Epydoc 3.0.1 on Mon Aug 26 16:53:51 2013
    </td>
    <td align="right" class="footer">
      <a target="mainFrame" href="http://epydoc.sourceforge.net"
        >http://epydoc.sourceforge.net</a>
    </td>
  </tr>
</table>

<script type="text/javascript">
  <!--
  // Private objects are initially displayed (because if
  // javascript is turned off then we want them to be
  // visible); but by default, we want to hide them.  So hide
  // them unless we have a cookie that says to show them.
  checkCookie();
  // -->
</script>
</body>
</html>
